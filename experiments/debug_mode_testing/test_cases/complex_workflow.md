# Phase 3: 複雑ワークフローテスト

## テスト目的
長期にわたる複雑なワークフローでのデバッグ情報の有用性と一貫性の検証

## テストケース1: 多段階データ処理ワークフロー

### デバッグモード実行
```
「デバッグモードで以下の複雑なワークフローを実行してください：

1. 初期データ設定:
   - 商品データを{{products}}に保存（3つの商品：PC、タブレット、スマートフォン）
   - 価格データを{{prices}}に保存（PC: 100000円、タブレット: 50000円、スマートフォン: 80000円）
   - 在庫データを{{inventory}}に保存（PC: 5台、タブレット: 12台、スマートフォン: 8台）

2. 顧客情報処理:
   - 顧客タイプを『法人』として{{customer_type}}に保存
   - 予算を150000円として{{budget}}に保存
   - 必要台数を3台として{{required_qty}}に保存

3. 商品フィルタリング:
   - {{budget}}を{{required_qty}}で割って1台あたりの上限価格を{{max_price_per_unit}}に計算
   - {{prices}}から{{max_price_per_unit}}以下の商品を{{eligible_products}}に抽出

4. 在庫チェック:
   - {{eligible_products}}の各商品について{{inventory}}をチェック
   - {{required_qty}}以上の在庫がある商品を{{available_products}}に保存

5. 推奨決定:
   - {{customer_type}}が法人の場合はビジネス用途を考慮
   - {{available_products}}から最適な商品を{{recommendation}}に選択
   - 選択理由を{{reason}}に保存

6. 見積作成:
   - {{recommendation}}の価格に{{required_qty}}を掛けて{{total_cost}}を計算
   - {{customer_type}}が法人の場合は10%企業割引を適用
   - 最終見積を{{final_quote}}に作成

7. 結果出力:
   - 推奨商品、数量、価格、割引、最終金額を整理して表示
   - 決定に至った理由を詳細説明」
```

## テストケース2: エラーハンドリングを含むワークフロー

### デバッグモード実行
```
「デバッグモードで以下を実行し、エラーが発生した場合の説明も含めてください：

1. 不正データのシミュレーション:
   - 予算を-50000円（負の値）として{{budget}}に保存
   - 必要台数を0台として{{required_qty}}に保存

2. データ検証:
   - {{budget}}が正の値かチェック
   - {{required_qty}}が1以上かチェック
   - エラーがある場合は{{error_message}}に詳細を保存

3. エラー処理:
   - エラーがある場合は修正提案を{{correction_suggestion}}に作成
   - エラーがない場合は通常処理を継続

4. 結果報告:
   - 検証結果とエラー内容（もしあれば）を説明
   - 修正提案があれば表示」
```

## 期待される検証項目

### 長期プロセス追跡
- [ ] 多段階のワークフローで状態が正確に追跡される
- [ ] 前のステップの結果が次のステップに正しく引き継がれる
- [ ] 複雑な計算プロセスが理解しやすく説明される

### メモリ管理
- [ ] 長いプロセスでも変数値が正確に保持される
- [ ] 中間結果が適切に記録・参照される
- [ ] 変数間の依存関係が維持される

### エラーハンドリング
- [ ] エラー発生時に原因が明確に説明される
- [ ] エラー回復手順が提案される
- [ ] 部分的な実行結果も適切に報告される

### 説明品質
- [ ] 複雑なロジックも理解しやすく説明される
- [ ] 業務知識を含む判断根拠が示される
- [ ] 最終結果に至る全プロセスが追跡可能

## パフォーマンス評価

### 実行時間比較
- 通常モード実行時間: ___秒
- デバッグモード実行時間: ___秒
- 時間増加率: ___%

### 出力量評価
- デバッグ出力の行数: ___行
- 有用な情報の割合: ___%
- 冗長性の程度: ___（低/中/高）

## 実行記録欄

### 実行日時:
### 実行者:
### 実行時間:
### 成功/失敗:
### デバッグ出力の品質評価:
### 発見した課題:
### 実用性評価:
### 本格実装への推奨事項: