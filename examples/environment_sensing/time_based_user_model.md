# 🕐 時間ベースユーザ状態モデル（Pattern 7 初級）

**概要**: 時間センシングによりユーザの忙しさを推定し、応答スタイルを自動調整するエージェントシステム

**学習目標**: 
- 環境センシング（時間取得）の基本
- ワールドモデル（ユーザ状態推定）の構築
- 状態ベースの行動切り替えの実装

**実行時間**: 3-5分

---

## 🎯 システム設計

### ユーザ状態モデル
```
時間帯         → ユーザ状態      → 応答スタイル
早朝（6-9時）   → 余裕あり       → 詳細説明
午前（9-12時）  → オフィスで忙しい → 短い要約
午後（12-18時） → 外仕事で忙しい  → 短い要約
夜（18時以降）  → リラックス     → 詳細説明
```

### 処理フロー
`時間センシング → ユーザ状態推定 → 応答スタイル決定 → 実行`

---

## Step 1: 環境センシング（時間情報取得）

現在時刻を確認し{{current_time}}に設定してください。

{{current_time}}から現在の時間を判定し{{hour}}に設定してください。

「=== 環境センシング結果 ===」と表示してください。
「現在時刻: {{current_time}}（{{hour}}時頃）」と表示してください。

---

## Step 2: ワールドモデル適用（ユーザ状態推定）

{{hour}}に基づいて以下のユーザモデルを適用してください：

**早朝（6-9時）の場合**:
→ {{user_state}}を「早朝・余裕あり」に設定
→ {{busy_level}}を「低」に設定
→ {{response_style}}を「詳細説明」に設定

**午前（9-12時）の場合**:
→ {{user_state}}を「午前・オフィスワーク忙しい」に設定
→ {{busy_level}}を「高」に設定
→ {{response_style}}を「短い要約」に設定

**午後（12-18時）の場合**:
→ {{user_state}}を「午後・外仕事忙しい」に設定
→ {{busy_level}}を「高」に設定
→ {{response_style}}を「短い要約」に設定

**夜（18時以降）の場合**:
→ {{user_state}}を「夜・リラックスタイム」に設定
→ {{busy_level}}を「低」に設定
→ {{response_style}}を「詳細説明」に設定

以下の情報をuser_state.jsonに保存してください：
```json
{
  "timestamp": "{{current_time}}",
  "hour": "{{hour}}",
  "user_state": "{{user_state}}",
  "busy_level": "{{busy_level}}",
  "response_style": "{{response_style}}"
}
```

「=== ワールドモデル推定結果 ===」と表示してください。
「推定ユーザ状態: {{user_state}}」と表示してください。
「忙しさレベル: {{busy_level}}」と表示してください。
「決定応答スタイル: {{response_style}}」と表示してください。

---

## Step 3: 状態ベース行動実行

「=== 応答スタイル実行テスト ===」と表示してください。

{{response_style}}に応じて「プログラミング学習のコツについて教えて」という質問に答えてください：

**「短い要約」の場合**:
3行以内で要点のみ簡潔に説明し、「忙しい時間帯のため概要のみお伝えしました。詳細は余裕のある時間帯にお聞きください。」を追加してください。

**「詳細説明」の場合**:
具体例や手順を含めて詳しく丁寧に説明し、「余裕のある時間帯なので詳しく説明いたします。」を追加してください。

実際に上記の条件で応答を実行してください。

応答完了後、「ユーザの忙しさに配慮した応答調整が完了しました」と表示してください。

---

## Step 4: ワールドモデル効果の検証

user_state.jsonを読み込んで{{model_state}}に設定してください。

「=== ワールドモデル効果検証 ===」と表示してください。

以下の観点で効果を確認してください：

### 環境センシング精度
- 現在時刻が正確に取得・判定できたか
- 時間帯の分類が適切に行われたか

### ユーザ状態推定精度  
- 時間情報からユーザの忙しさが適切に推定できたか
- 想定されたユーザモデルが正しく適用されたか

### 行動切り替え効果
- ユーザ状態に応じて応答スタイルが切り替わったか
- 忙しい時は簡潔に、余裕の時は詳しく説明できたか

### ワールドモデルの価値
- ユーザが明示的に要求していない配慮（忙しさへの対応）ができたか
- エージェントが「ユーザのことを理解している」印象を与えられたか

「時間ベースユーザ状態モデルによる適応的応答システムを確認しました」と表示してください。

---

## 🎓 学習ポイント

### Pattern 7の要素実践
1. **環境センシング**: dateコマンドによる実時間取得
2. **ワールドモデル**: 時間→ユーザ状態の推定ロジック
3. **状態ベース判断**: 推定状態からの行動決定
4. **適応的実行**: 状況に応じた異なる応答スタイル

### ワールドモデルの本質的価値
- **予測的配慮**: ユーザが要求する前に状況を理解
- **文脈適応**: 同じ質問でも時間帯により応答を調整
- **個人化**: ユーザの生活パターンに合わせた最適化

### 他パターンとの連携
- **Sequential Pipeline**: センシング→推定→判断→実行の順次処理
- **Conditional Execution**: ユーザ状態による条件分岐
- **Learning from Experience**: 応答効果の学習による精度向上

---

## 🔄 発展学習

### 異なる時間帯での実験
- 朝の時間帯: 詳細説明モードの体験
- 昼の時間帯: 短い要約モードの体験
- 夜の時間帯: リラックスモードの体験

### モデルの改良
- より細かい時間分割（30分単位等）
- 曜日効果の組み込み（月曜は重い、金曜は軽い等）
- 季節・天候要因の追加

### 実用的応用
- メール返信スタイルの自動調整
- 会議リマインダーの表現調整
- 学習コンテンツの提示形式最適化

