# プレゼンテーション品質最適化システム（中級）

## Claude Code自然言語マクロプログラミング構文

```markdown
- `##` マークダウン見出し：順次実行するメインタスク
- `###` マークダウン見出し：Task toolを利用して並列実行されるサブタスク
- 条件分岐: 自然言語による条件指示（「...の場合は」「...に応じて」など）
- `{{variable_name}}`：結果参照
- 結果保存：「...を{{variable_name}}に保存してください」
- 永続化保存：「{{variable_name}}をfilename.jsonに保存して永続化してください」
- ファイル読み込み：「filename.jsonを読み込んで{{variable_name}}に設定してください」
- 外部モジュール実行：「filename.mdの実行をしてください」
- ツール使用：自然言語で指示（例：「Webで調べて」「ファイルを読んで」）
```

**概要**: プレゼンテーション資料を複数の評価軸で反復的に改善する高度なLoop & Modular Programmingシステム。内容・構成・表現の3軸で品質を評価し、目標達成まで継続的に最適化を実行する。

**学習目標**: 
- 複数状態変数の管理
- 複合条件による終了判定
- 安全機構付きループ制御
- 高度なモジュール設計

---

## 初期設定

プレゼンテーションテーマを「AI技術の未来」として{{theme}}に設定してください。

品質スコアを以下のように設定してください：
- 内容品質を40として{{content_score}}に設定
- 構成品質を35として{{structure_score}}に設定  
- 表現品質を30として{{presentation_score}}に設定

改善回数を0として{{iteration}}に設定してください。
最大改善回数を10として{{max_iterations}}に設定してください。
改善履歴を空として{{improvement_history}}に設定してください。

「=== プレゼンテーション品質最適化システム開始 ===」と表示してください。
「テーマ: {{theme}}」と表示してください。

## 初期プレゼンテーション内容の記録

改善前の基準として、現在の品質レベル（内容40、構成35、表現30）に応じた初期プレゼンテーション内容を生成し、{{initial_presentation}}に保存してください：

「{{theme}}」について、以下の品質レベルでプレゼンテーション内容を作成：
- 基本的な情報のみ（内容品質40レベル）
- シンプルな3部構成（構成品質35レベル）  
- 平易で基本的な表現（表現品質30レベル）

実際のスライド構成と各スライドの要点を含めて作成してください。

## 品質最適化ループ

以下の条件のいずれかが満たされるまで改善を継続してください：

**主目標条件**:
- {{content_score}}、{{structure_score}}、{{presentation_score}}が全て75以上
- または3つのスコアの平均が85以上

**安全制限条件**:
- {{iteration}}が{{max_iterations}}に達した場合

各改善サイクルで以下を実行してください：

{{iteration}}に1を加算してください。

「=== 改善サイクル {{iteration}}/{{max_iterations}} ===」と表示してください。

### 安全チェック

{{iteration}}が{{max_iterations}}の80%（8回）を超えた場合：
→ 「警告: 最大改善回数に接近しています（{{iteration}}/{{max_iterations}}）」と表示
→ 「警告: 改善回数制限接近」を{{improvement_history}}に記録

{{iteration}}が{{max_iterations}}に達した場合：
→ 「安全制限: 最大改善回数に達しました」と表示
→ 改善ループを終了

### 品質分析・改善実行

quality_analyzer.mdの実行をしてください。

### 進捗確認

現在の品質状況を表示してください：
- 内容品質: {{content_score}}/100
- 構成品質: {{structure_score}}/100  
- 表現品質: {{presentation_score}}/100
- 平均品質: ({{content_score}} + {{structure_score}} + {{presentation_score}}) / 3

## 最適化完了判定

達成した終了条件を判定し表示してください：
- 個別品質目標達成（全て75以上）
- 平均品質目標達成（85以上）
- 安全制限による終了

## 最終プレゼンテーション内容の生成

最適化完了後の品質レベル（内容{{content_score}}、構成{{structure_score}}、表現{{presentation_score}}）に応じた最終プレゼンテーション内容を生成し、{{final_presentation}}に保存してください：

「{{theme}}」について、以下の改善された品質レベルでプレゼンテーション内容を作成：
- 充実した内容と論理構造（内容品質{{content_score}}レベル）
- 最適化された構成と流れ（構成品質{{structure_score}}レベル）
- 魅力的で分かりやすい表現（表現品質{{presentation_score}}レベル）

実際のスライド構成と各スライドの詳細な要点を含めて作成してください。

## 最終レポート

「=== プレゼンテーション品質最適化完了 ===」と表示してください。

### 📊 最適化結果サマリー

以下の最適化結果を報告してください：
- プレゼンテーションテーマ: {{theme}}
- 最終品質スコア:
  - 内容品質: {{content_score}}/100
  - 構成品質: {{structure_score}}/100
  - 表現品質: {{presentation_score}}/100
  - 平均品質: 計算結果
- 実行した改善サイクル数: {{iteration}}/{{max_iterations}}
- 改善履歴: {{improvement_history}}
- 終了理由: 判定結果

### 🔄 Before-After 比較

**【改善前プレゼンテーション】**
{{initial_presentation}}

**【改善後プレゼンテーション】**  
{{final_presentation}}

### 💡 改善効果の分析

以下の観点から改善効果を分析してください：

**内容品質の変化**:
- 改善前後の情報量と深度の違いを比較
- 論理構造と具体例の追加効果を説明
- 専門性と実用性の向上点を評価

**構成品質の変化**:
- スライド構成の最適化効果を分析
- セクション間の流れとつながりの改善を評価
- 聴衆の理解促進に寄与する構成要素を特定

**表現品質の変化**:
- 分かりやすさと魅力度の向上を評価
- 視覚的要素と表現技法の改善効果を分析
- プロフェッショナルレベルへの到達度を確認

### 🎯 ユーザーへの実用的コメント

改善されたプレゼンテーションの実用性について：
- 最も顕著な改善点とその効果
- 実際のプレゼンテーション実施時に期待できる成果
- さらなる品質向上のための推奨事項

最適化プロセス全体の評価と今後の活用方法を提示してください。

---

## システムの特徴

**複数軸評価**: 内容・構成・表現の3軸で総合品質を評価  
**複合条件終了**: 個別目標 OR 平均目標の柔軟な達成判定  
**安全機構**: 無限ループ防止と進捗監視  
**実用性**: 実際のプレゼンテーション改善に適用可能