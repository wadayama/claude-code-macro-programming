# 品質分析・改善モジュール

## Claude Code自然言語マクロプログラミング構文

```markdown
- `##` マークダウン見出し：順次実行するメインタスク
- `###` マークダウン見出し：Task toolを利用して並列実行されるサブタスク
- 条件分岐: 自然言語による条件指示（「...の場合は」「...に応じて」など）
- `{{variable_name}}`：結果参照
- 結果保存：「...を{{variable_name}}に保存してください」
- 永続化保存：「{{variable_name}}をfilename.jsonに保存して永続化してください」
- ファイル読み込み：「filename.jsonを読み込んで{{variable_name}}に設定してください」
- 外部モジュール実行：「filename.mdの実行をしてください」
- ツール使用：自然言語で指示（例：「Webで調べて」「ファイルを読んで」）
```

**概要**: プレゼンテーション品質最適化システムの中核処理モジュール。内容・構成・表現の3軸を独立分析し、各軸に適した改善処理を実行する。

**変数管理**:
- `{{content_score}}`: 内容品質スコア（参照・更新）
- `{{structure_score}}`: 構成品質スコア（参照・更新）
- `{{presentation_score}}`: 表現品質スコア（参照・更新）
- `{{improvement_history}}`: 改善履歴（追記）
- `{{iteration}}`: 現在の改善回数（参照のみ）
- `{{theme}}`: プレゼンテーションテーマ（参照のみ）

---

## 現在品質の分析

現在の品質状況を分析してください：

「--- 品質分析 サイクル{{iteration}} ---」と表示してください。

現在のスコアを表示してください：
- 内容品質: {{content_score}}点
- 構成品質: {{structure_score}}点
- 表現品質: {{presentation_score}}点

最も改善が必要な軸を特定し、改善戦略を決定してください。

## 内容品質の改善

{{content_score}}の値に応じて内容改善を実行してください：

{{content_score}}が60未満の場合：
→ 「内容基盤強化を実行します」と表示してください
→ 「{{theme}}の核心概念を明確化し、論理構造を構築します」として処理
→ {{content_score}}に12を加算してください
→ 「内容基盤強化: +12点」を{{improvement_history}}に追記してください

{{content_score}}が60以上75未満の場合：
→ 「内容深化改善を実行します」と表示してください
→ 「{{theme}}の詳細分析と具体例を追加します」として処理
→ {{content_score}}に9を加算してください
→ 「内容深化改善: +9点」を{{improvement_history}}に追記してください

{{content_score}}が75以上の場合：
→ 「内容精緻化を実行します」と表示してください
→ 「{{theme}}の最新知見と独自視点を統合します」として処理
→ {{content_score}}に6を加算してください
→ 「内容精緻化: +6点」を{{improvement_history}}に追記してください

## 構成品質の改善

{{structure_score}}の値に応じて構成改善を実行してください：

{{structure_score}}が60未満の場合：
→ 「構成基本設計を実行します」と表示してください
→ 「導入・本論・結論の基本構造を最適化します」として処理
→ {{structure_score}}に11を加算してください
→ 「構成基本設計: +11点」を{{improvement_history}}に追記してください

{{structure_score}}が60以上75未満の場合：
→ 「構成流れ改善を実行します」と表示してください
→ 「セクション間の論理的接続と流れを向上させます」として処理
→ {{structure_score}}に8を加算してください
→ 「構成流れ改善: +8点」を{{improvement_history}}に追記してください

{{structure_score}}が75以上の場合：
→ 「構成洗練化を実行します」と表示してください
→ 「聴衆の注意維持と理解促進の構成技法を適用します」として処理
→ {{structure_score}}に5を加算してください
→ 「構成洗練化: +5点」を{{improvement_history}}に追記してください

## 表現品質の改善

{{presentation_score}}の値に応じて表現改善を実行してください：

{{presentation_score}}が60未満の場合：
→ 「表現基礎改善を実行します」と表示してください
→ 「明確性と分かりやすさを重視した表現に改善します」として処理
→ {{presentation_score}}に13を加算してください
→ 「表現基礎改善: +13点」を{{improvement_history}}に追記してください

{{presentation_score}}が60以上75未満の場合：
→ 「表現魅力向上を実行します」と表示してください
→ 「聴衆の関心を引く表現技法と視覚的要素を強化します」として処理
→ {{presentation_score}}に10を加算してください
→ 「表現魅力向上: +10点」を{{improvement_history}}に追記してください

{{presentation_score}}が75以上の場合：
→ 「表現完成度向上を実行します」と表示してください
→ 「プロフェッショナルレベルの表現技法を適用します」として処理
→ {{presentation_score}}に7を加算してください
→ 「表現完成度向上: +7点」を{{improvement_history}}に追記してください

## 改善結果の確認

改善後の品質スコアを表示してください：
- 内容品質: {{content_score}}点（改善効果を表示）
- 構成品質: {{structure_score}}点（改善効果を表示）  
- 表現品質: {{presentation_score}}点（改善効果を表示）

「品質改善サイクル{{iteration}}完了」と表示してください。

次回の改善で重点的に取り組むべき軸があれば推奨事項として提示してください。