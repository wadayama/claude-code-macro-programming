# 🎯 Learning from Experience 中級: プロンプト継続改良システム

**システム概要**: 初期プロンプトを段階的に改良し、ブログ記事タイトル生成の品質を継続的に向上させる学習システム

**重要**: このシステムでは、Loop Pattern + Learning from Experienceを統合し、プロンプトエンジニアリングの自動化・継続改善を実現します。過去の実行履歴から学習し、より効果的なプロンプトを段階的に構築していきます。

**学習目標**:
- プロンプト改善の体系的アプローチ習得
- 評価指標設計と客観的改善プロセスの実践
- Loop Pattern + Learning from Experienceの実用的統合

---

## 完全初期化（クリーンスタート）

variables.jsonが存在すれば削除してください
TODOリストをすべてクリアしてください

「=== プロンプト継続改良システム 処理開始 ===」と表示してください。

## Phase 1: プロンプト改良問題の設定

今回の改良対象は以下のタスクです：

**タスク**: ブログ記事タイトル生成の最適化
**初期プロンプト**: 「以下のブログ記事の内容に基づいて、魅力的なタイトルを5つ生成してください」
**制約**: 最大7回の改良試行
**目標**: 評価指標の総合スコア最大化

**評価軸**:
- **魅力度** (1-10): タイトルの読者への訴求力
- **具体性** (1-10): 内容の具体性・明確性  
- **SEO効果** (1-10): 検索エンジン最適化の観点
- **クリック誘導性** (1-10): クリックを促す力

---

## Phase 2: 改良履歴の初期化

以下の構造でprompt_history.jsonファイルを作成し、改良履歴を初期化してください：

```json
{
  "prompt_history": [],
  "current_best": {
    "prompt_text": null,
    "overall_score": null,
    "iteration": null
  },
  "learning_patterns": [],
  "improvement_notes": []
}
```

改良回数を0として{{improvement_count}}に設定してください。

---

## Phase 3: プロンプト改良ループの実行

以下の停止条件のいずれかに達するまで、以下を繰り返してください：

**停止条件**:
1. {{improvement_count}}が7回に達した場合
2. 連続2回の評価で総合スコアの改善が0.5以下の場合

{{improvement_count}}が7回に達するか、早期停止条件を満たすまで繰り返してください：

### プロンプト設定
{{improvement_count}}に1を加算してください。

「=== 改良回数 {{improvement_count}} ===」と表示してください。

prompt_history.jsonを読み込んで{{prompt_history}}に設定してください。

{{prompt_history}}を参照して、今回使用するプロンプトを決定してください：

初回（{{improvement_count}} = 1）の場合：
→ 初期プロンプト「以下のブログ記事の内容に基づいて、魅力的なタイトルを5つ生成してください」を使用

2回目以降の場合：
→ {{prompt_history}}の内容を分析し、**以下を明確に説明した上で**改良プロンプトを作成してください：
  - 過去のどの評価結果から何を学習したか
  - なぜその改良が効果的と判断したか  
  - どのような仮説・戦略に基づく改良か
  - 具体的にどの部分をどう変更したか

決定したプロンプトを{{current_prompt}}に設定し、「使用プロンプト: {{current_prompt}}」と表示してください。

### サンプル記事の読み込み
sample_article_content.mdを読み込んで{{article_content}}に設定してください。

### プロンプト実行
{{current_prompt}}と{{article_content}}を使用して、ブログ記事タイトルを5つ生成してください。

生成されたタイトルを{{generated_titles}}に設定してください。

「生成タイトル:」として{{generated_titles}}を表示してください。

### 評価実行
生成された{{generated_titles}}について、以下の4つの評価軸で採点してください：

**評価基準**:
- **魅力度** (1-10): 読者の関心を引く力、感情に訴える表現
- **具体性** (1-10): 内容の明確さ、具体的な情報の含有
- **SEO効果** (1-10): 検索されやすいキーワードの含有、最適化度
- **クリック誘導性** (1-10): クリックしたくなる表現、好奇心の喚起

各タイトルを個別評価した上で、**5つのタイトル全体**として以下を算出してください：
- 各評価軸の平均スコア
- 総合スコア（4つの評価軸の平均）

評価結果を{{evaluation_scores}}に設定してください。

「評価結果:」として{{evaluation_scores}}を表示してください。

### 履歴の更新
評価結果を{{prompt_history}}に追加し、prompt_history.jsonを更新してください：

```json
{
  "iteration": "{{improvement_count}}",
  "prompt_text": "{{current_prompt}}",
  "generated_titles": {{generated_titles}},
  "evaluation_scores": {{evaluation_scores}},
  "improvement_strategy": "あなたが使用した改良戦略の説明",
  "insights": "この結果から得られた気づき"
}
```

現在の最良スコア（最高の総合スコア）を確認し、更新が必要であればcurrent_bestを更新してください。

### 学習・改善分析
評価結果について以下を分析し、learning_patternsとimprovement_notesに記録してください：

**学習パターン抽出**:
- どのようなプロンプト要素が高評価に結びついたか
- 低評価の原因となった要素は何か
- 評価軸間の相関関係（例：具体性向上がSEO効果も改善）

**改善戦略の検証**:
- 事前に立てた改良仮説が正しかったか
- 予想外の結果から得られた新しい知見
- 次回改良のための戦略調整内容

### 早期停止条件の確認
現在の{{improvement_count}}回目の評価後、以下を確認してください：

**連続改善チェック**:
- 前回の最良スコアと今回の最良スコアの差を計算
- 前々回の最良スコアと前回の最良スコアの差を計算
- 両方の改善が0.5以下の場合、「連続2回で改善が0.5以下」として早期停止を実行

早期停止条件を満たした場合は「=== 早期停止条件達成 ===」と表示してPhase 4に進んでください。

---

## Phase 4: プロンプト改良結果の分析

改良ループ完了後、以下の分析を実行してください：

### 最終結果の評価
{{prompt_history}}から改良結果を分析してください：

- **最終最適プロンプト**: current_bestのプロンプト
- **最高総合スコア**: 達成した最高評価スコア
- **改良効率性**: 最大7回の試行でどの程度改善できたか

### プロンプト改良プロセスの進化分析
{{prompt_history}}の改良プロセスの変遷を分析してください：

- **初期段階の改良**: 最初の数回でどのような改良アプローチを行ったか
- **中期の学習**: 評価結果から何を学習し、戦略をどう調整したか
- **終盤の最適化**: 蓄積された知見をどう活用し、精密化を図ったか

### 効果的改良パターンの発見
改良プロセスから効果的なプロンプト改良パターンを抽出してください：

- **高評価要素**: どのような要素が高評価に結びついたか
- **改良技法**: 効果的だった具体的な改良手法
- **評価軸最適化**: 各評価軸を向上させる効果的アプローチ

### 学習vs探索のバランス
改良プロセスにおける学習（過去知見の活用）と探索（新しいアプローチの試行）のバランスを分析してください：

- **学習重視段階**: 過去の成功パターンを活用した段階
- **探索重視段階**: 新しい改良アプローチを試行した段階
- **バランス調整**: 両者のバランスをどのように調整したか

---

## Phase 5: 改良成果の総括

### 習得したプロンプト改良技法
この経験から学習した効果的なプロンプト改良手法を整理してください：

- **評価駆動改良**: 評価結果に基づく体系的改良アプローチ
- **要素分析技法**: プロンプト構成要素と評価結果の関係分析
- **段階的最適化**: 継続的改良による品質向上手法

### 汎用的プロンプト改良指針
この経験から、一般的なプロンプト改良に適用できる指針を作成してください：

- **構造化改良戦略**: プロンプトの構造的改良アプローチ
- **評価指標設計**: 効果的な評価指標の設計・運用方法
- **収束判定技法**: 改良プロセスの効率的な終了判定手法

---

## 学習完了

「プロンプト継続改良システム完了！」と表示し、以下について振り返ってください：

- **改良性能**: 達成した改良効果と改良効率性
- **学習進化**: プロンプト改良思考の発達過程と習得した改良技法
- **応用可能性**: 他のプロンプト改良タスクへの適用展望

## システムクリーンアップ

次回実行時のために、prompt_history.jsonファイルを削除してください。
これにより、次回実行時に新しいプロンプト改良学習を純粋に体験できます。